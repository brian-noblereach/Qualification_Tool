<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCA Market Opportunity Scorer</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Compact Header -->
        <div class="header">
            <div class="company-info">
                <h1 id="companyName">Market Opportunity Assessment</h1>
                <div class="company-meta" id="companyMeta">Enter technology description to begin assessment</div>
            </div>
            <div class="header-actions">
                <button class="btn-secondary" id="newAnalysisBtn" style="display: none;">New Analysis</button>
                <button class="btn-primary" id="exportBtn" style="display: none;">Export PDF</button>
            </div>
        </div>

        <!-- Input Section -->
        <section class="input-section" id="inputSection">
            <div class="input-grid">
                <div class="input-field">
                    <label>Technology Description</label>
                    <textarea id="techDescription" placeholder="Describe the technology, product, or service..." rows="4"></textarea>
                </div>
                <div class="input-field">
                    <label>Competitive Analysis</label>
                    <textarea id="competitiveAnalysis" placeholder="Provide competitive landscape analysis..." rows="4"></textarea>
                </div>
            </div>
            <button class="btn-primary analyze-btn" id="analyzeBtn">Analyze Market Opportunity</button>
        </section>

        <!-- Loading State -->
        <section class="loading-section" id="loadingSection" style="display: none;">
            <div class="loading-content">
                <div class="spinner"></div>
                <h2>Analyzing Market Opportunity</h2>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="status-text" id="progressStatus">Gathering market data...</div>
                <div class="time-text" id="timeElapsed">0:00</div>
            </div>
        </section>

        <!-- Main Assessment Interface -->
        <section class="assessment-section" id="assessmentSection" style="display: none;">
            <div class="two-panel-layout">
                <!-- Left Panel: Rubric & Scoring -->
                <div class="rubric-panel">
                    <div class="panel-header">
                        <h2>Market Opportunity Scoring</h2>
                        <div class="ai-score-badge">
                            <span class="badge-label">AI Score</span>
                            <span class="badge-value" id="aiScore">-</span>
                        </div>
                    </div>

                    <!-- User Score Slider -->
                    <div class="scoring-container">
                        <div class="score-display" id="userScoreDisplay">5</div>
                        <input type="range" min="1" max="9" value="5" class="score-slider" id="userScoreSlider">
                        <div class="score-labels">
                            <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                            <span>6</span><span>7</span><span>8</span><span>9</span>
                        </div>
                    </div>

                    <!-- Dynamic Rubric Description -->
                    <div class="rubric-description" id="rubricDescription">
                        <h3>Score 5: Moderate Market</h3>
                        <p>TAM between $500M and $5B with CAGR between 10% and 35%</p>
                    </div>

                    <!-- Rubric Reference Table -->
                    <div class="rubric-table">
                        <div class="rubric-row score-1-3">
                            <span class="score">1-3</span>
                            <div class="criteria">
                                <div>TAM <$500M</div>
                                <div>Weak growth potential</div>
                            </div>
                        </div>
                        <div class="rubric-row score-4-5">
                            <span class="score">4-5</span>
                            <div class="criteria">
                                <div>TAM $500M-$5B</div>
                                <div>CAGR <35%</div>
                            </div>
                        </div>
                        <div class="rubric-row score-6-7 active">
                            <span class="score">6-7</span>
                            <div class="criteria">
                                <div>TAM $500M-$5B & CAGR >35%</div>
                                <div>OR TAM >$5B & CAGR 10-35%</div>
                            </div>
                        </div>
                        <div class="rubric-row score-8-9">
                            <span class="score">8-9</span>
                            <div class="criteria">
                                <div>TAM >$5B</div>
                                <div>CAGR >35%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Assessment Comment -->
                    <div class="comment-container">
                        <label>Assessment Rationale</label>
                        <textarea id="scoreComment" placeholder="Required: Explain your scoring decision..." rows="3"></textarea>
                        <div class="deviation-warning" id="deviationWarning" style="display: none;">
                            âš  Score differs significantly from AI assessment
                        </div>
                        <button class="btn-primary submit-btn" id="submitScoreBtn">Submit Assessment</button>
                    </div>
                </div>

                <!-- Right Panel: Supporting Evidence -->
                <div class="evidence-panel">
                    <div class="panel-header">
                        <h2>Supporting Evidence</h2>
                        <div class="view-tabs">
                            <button class="tab active" data-view="summary">Summary</button>
                            <button class="tab" data-view="detailed">Detailed</button>
                            <button class="tab" data-view="sources">Sources</button>
                        </div>
                    </div>

                    <div class="panel-content">
                        <!-- Summary View -->
                        <div class="view-content" id="summaryView">
                            <div class="key-metrics">
                                <div class="metric-card">
                                    <label>TAM</label>
                                    <value id="tamValue">-</value>
                                </div>
                                <div class="metric-card">
                                    <label>CAGR</label>
                                    <value id="cagrValue">-</value>
                                </div>
                                <div class="metric-card full-width">
                                    <label>Primary Market</label>
                                    <value id="marketDesc">-</value>
                                </div>
                            </div>

                            <div class="ai-reasoning">
                                <div class="reasoning-header">
                                    <span class="ai-badge">AI</span>
                                    <strong>AI Reasoning for Score: <span id="aiScoreReason">-</span></strong>
                                </div>
                                <p id="aiReasoning">-</p>
                            </div>

                            <div class="evidence-grid">
                                <div class="evidence-card strengths">
                                    <h4>Key Strengths</h4>
                                    <ul id="strengthsList"></ul>
                                </div>
                                <div class="evidence-card limitations">
                                    <h4>Key Limitations</h4>
                                    <ul id="limitationsList"></ul>
                                </div>
                            </div>

                            <div class="show-more-container">
                                <button class="show-more-btn" id="showMoreBtn">Show More Details</button>
                            </div>
                        </div>

                        <!-- Detailed View -->
                        <div class="view-content" id="detailedView" style="display: none;">
                            <div class="detail-section">
                                <h3>Market Analysis</h3>
                                <div id="marketAnalysis"></div>
                            </div>
                            <div class="detail-section">
                                <h3>All Strengths</h3>
                                <ul id="allStrengthsList"></ul>
                            </div>
                            <div class="detail-section">
                                <h3>All Limitations</h3>
                                <ul id="allLimitationsList"></ul>
                            </div>
                            <div class="detail-section">
                                <h3>Key Risks</h3>
                                <ul id="risksList"></ul>
                            </div>
                        </div>

                        <!-- Sources View -->
                        <div class="view-content" id="sourcesView" style="display: none;">
							<table class="sources-table">
								<thead>
									<tr>
										<th>Market</th>
										<th>TAM</th>
										<th>CAGR</th>
										<th>Source</th>
									</tr>
								</thead>
								<tbody id="sourcesTableBody"></tbody>
							</table>
						</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Error Section -->
        <section class="error-section" id="errorSection" style="display: none;">
            <div class="error-content">
                <h2>âš  Error</h2>
                <p id="errorMessage">An error occurred</p>
                <button class="btn-primary" id="retryBtn">Retry Analysis</button>
            </div>
        </section>
    </div>

    <script src="api.js"></script>
    <script src="app.js"></script>
</body>
</html>